Ссылка на streamlit: https://9yrmkzibpnaamdzmce3dd8.streamlit.app

1. Для начала я сделала EDA
В рамках него мы посмотрели случайные наблюдения, чтобы оценить переменные, с которыми мы будем работать и приблизительные значения, которые они могут принимать. Затем были сделаны преобразования над конкретными полями, к примеру убрали буквенные обозначения, которые мешали интерпретировать числовые переменные. Так же удалили достаточно больше количество дубликатов и заполнили пропуски. 

2. Визуализация
После того как мы привели данные к более валидному виду сделаем визуализацию, чтобы посмотреть на корреляцию признаков, а так же распределение категориальных переменных. С помощью визуализации можно сделать следующие выводы:

Year: чем выше цена, тем в среднем новее год автомобиля
Km_driven: чем выше цена, тем в среднем меньше пробег
Mileage: нет такой четкой корреляции как в предыдущих пунктах. Но как правило с увеличением цены уменьшается дисперсия переменной
Engine: тоже нет четкой корреляции, но в среднем наблюдается рост engine с увеличением цены
Max_power: много выбросов, где при низкой цене высокая power. Но как правило наблюдается положительная корреляция между ценой и max_power
Seats: наивысшая цена у машин с меньшим количеством мест. Но возможно это объясняется тем, что в датасете в принципе мало машин с большим количеством мест
- с увеличением года растет показатель engine и max_power
- с уменьшением mileage увеличивается engine и max_power
- положительная корреляция между max_power и engine
- с увеличением количества мест как правило сокращается max_power
- наименее скоррелированы переменные engine и year
- высокая корреляция между max_power и engine, seats и engine, max_power и selling_proce

3. Модель только на вещественных признаках
Для первоначальной оценки можем построить модель на вещественных признаках, а именно линейную регрессию. В результате получаем метрики

MSE: 137676237761.9257
R² в процентах: 61.55%

Мы получили сильно большой MSE, что говорит о проблемах в модели
Модель объясняет 61.55% дисперсии целевой переменной. Что допустимо, но все еще далеко от 100%

4. Стандартизация
Применение стандартизации и линейная регрессия незначительно повиляли на результаты модели, R2 остался на прежнем уровне, MSE совсем незначительно упал

5. Регуляризация (Lasso)
Метрики так же сильно не изменились
MSE: 137677865541.4090
R² в процентах: 61.55%

6. Применение GridSearchCV

Для ElasticNet получили отрицательный R2

7. One-hot кодирование
Предыдущие способы улучшить предсказания модели не дали положительных результатов, попробуем обратно добавить категориальные переменные и применить к ним one-hot кодирование. 

После one-hot кодирования используем модель Ridge и подберем гиперпараметры с помощью GridSearchCV
Результаты:
R² в процентах: 65.69%
Добавление категориальных переменных улучшило результаты!!!

Метрики:

Линейная регрессия до стандартизации
MSE: 137676237761.9257 - в среднем  модель ошибается на 371000 единиц
R² в процентах: 61.55% - модель объясняет 61% дисперсии

Линейная регрессия после стандартизации
MSE: 137676237761.9220
R² в процентах: 61.55%

Lasso
MSE: 137677865541.4090
R² в процентах: 61.55%

ElasticNet
R² в процентах: -3452187658.87% - модель хуже, чем среднее значение

Ridge
R² в процентах: 65.69% - самый высокий результат! 

Доля прогнозов, отличающихся от реальных цен на эти авто не более чем на 10%
0.23523093447905477
0.23523093447905477
0.23523093447905477
0.0
0.0
0.24812030075187969
Выше всего последний результат, который соответствует Ridge модели. 

Наибольший прирост качества дало one-hot кодирование и добавление категориальных переменных

Нам не удалось получить улучшения качества от GridSearchCV (как в примере с ElasticNet)


StreamLit

Для первоначального анализа сервис получился неплохим. Он достаточно быстро обрабатывает данные и строит графики. Визуализация получилась хорошей, не уступает той, что была в ноутбуке. 

Проблемы: необходимо было добавить кнопку “show dataframe”, чтобы не было ошибки из-за того, что датафрэйм приходит на вход только после загрузки потребителем. 

Возможные улучшения:  визуальное качество датасэта с предсказанными значениями, добавить больше визуализаций и моделей, а не только линейную регрессию. На данный момент модель строится без категориальных переменных. В дальнейшем, можно было бы их добавить
